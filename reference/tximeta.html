<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Import transcript quantification with metadata — tximeta • tximeta</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Import transcript quantification with metadata — tximeta"><meta property="og:description" content="tximeta leverages the hashed checksum of the Salmon index,
in addition to a number of core Bioconductor packages (GenomicFeatures,
ensembldb, AnnotationHub, GenomeInfoDb, BiocFileCache) to automatically
populate metadata for the user, without additional effort from the user.
Note that tximeta requires that the entire output directory of Salmon
or alevin is present and unmodified in order to identify the provenance of the
reference transcripts."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tximeta</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.19.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/tximeta.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/thelovelab/tximeta/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Import transcript quantification with metadata</h1>
    <small class="dont-index">Source: <a href="https://github.com/thelovelab/tximeta/blob/HEAD/R/tximeta.R" class="external-link"><code>R/tximeta.R</code></a></small>
    <div class="hidden name"><code>tximeta.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>tximeta</code> leverages the hashed checksum of the Salmon index,
in addition to a number of core Bioconductor packages (GenomicFeatures,
ensembldb, AnnotationHub, GenomeInfoDb, BiocFileCache) to automatically
populate metadata for the user, without additional effort from the user.
Note that <code>tximeta</code> requires that the entire output directory of Salmon
or alevin is present and unmodified in order to identify the provenance of the
reference transcripts.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tximeta</span><span class="op">(</span></span>
<span>  <span class="va">coldata</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"salmon"</span>,</span>
<span>  txOut <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  skipMeta <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  skipSeqinfo <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  useHub <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  markDuplicateTxps <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cleanDuplicateTxps <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  customMetaInfo <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>coldata</dt>
<dd><p>a data.frame with at least two columns (others will propogate to object):</p><ul><li><p><code>files</code> - character, paths of quantification files</p></li>
<li><p><code>names</code> - character, sample names</p></li>
</ul><p>if <code>coldata</code> is a vector, it is assumed to be the paths of quantification files
and unique sample names are created</p></dd>


<dt>type</dt>
<dd><p>what quantifier was used (see <code>tximport</code>)</p></dd>


<dt>txOut</dt>
<dd><p>whether to output transcript-level data.
<code>tximeta</code> is designed to have transcript-level output
with Salmon, so default is <code>TRUE</code>,
and it's recommended to use <code>summarizeToGene</code>
following <code>tximeta</code> for gene-level summarization.
For an alevin file, <code>tximeta</code> will import the
gene level counts ignoring this argument (alevin
produces only gene-level quantification).</p></dd>


<dt>skipMeta</dt>
<dd><p>whether to skip metadata generation
(e.g. to avoid errors if not connected to internet).
This calls <code>tximport</code> directly and so either
<code>txOut=TRUE</code> or <code>tx2gene</code> should be specified.</p></dd>


<dt>skipSeqinfo</dt>
<dd><p>whether to skip the addition of Seqinfo,
which requires an internet connection to download the
relevant chromosome information table from UCSC</p></dd>


<dt>useHub</dt>
<dd><p>whether to first attempt to download a TxDb/EnsDb
object from AnnotationHub, rather than creating from a
GTF file from FTP (default is TRUE). If FALSE, it will
force <code>tximeta</code> to download and parse the GTF</p></dd>


<dt>markDuplicateTxps</dt>
<dd><p>whether to mark the status
(<code>hasDuplicate</code>) and names of duplicate transcripts
(<code>duplicates</code>) in the rowData of the SummarizedExperiment output.
Subsequent summarization to gene level will keep track
of the number of transcripts sets per gene (<code>numDupSets</code>)</p></dd>


<dt>cleanDuplicateTxps</dt>
<dd><p>whether to try to clean
duplicate transcripts (exact sequence duplicates) by replacing
the transcript names that do not appear in the GTF
with those that do appear in the GTF</p></dd>


<dt>customMetaInfo</dt>
<dd><p>the relative path to a custom metadata
information JSON file, relative to the paths in <code>files</code> of
<code>coldata</code>. For example, <code>customMetaInfo="meta_info.json"</code>
would indicate that in the same directory as the quantification
files in <code>files</code>, there are custom metadata information
JSON files. These should contain the SHA-256 hash of the
reference transcripts with the <code>index_seq_hash</code> tag
(see details in vignette).</p></dd>


<dt>...</dt>
<dd><p>arguments passed to <code>tximport</code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a SummarizedExperiment with metadata on the <code>rowRanges</code>.
(if the hashed checksum in the Salmon or Sailfish index does not match
any known transcriptomes, or any locally saved <code>linkedTxome</code>,
<code>tximeta</code> will just return a non-ranged SummarizedExperiment)</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Most of the code in <code>tximeta</code> works to add metadata and transcript ranges
when the quantification was performed with Salmon. However,
<code>tximeta</code> can be used with any quantification <code>type</code> that is supported
by <code>tximport</code>, where it will return an non-ranged SummarizedExperiment.</p>
<p><code>tximeta</code> performs a lookup of the hashed checksum of the index
(stored in an auxilary information directory of the Salmon output)
against a database of known transcriptomes, which lives within the tximeta
package and is continually updated on Bioconductor's release schedule.
In addition, <code>tximeta</code> performs a lookup of the checksum against a
locally stored table of <code>linkedTxome</code>'s (see <code>link{makeLinkedTxome}</code>).
If <code>tximeta</code> detects a match, it will automatically populate,
e.g. the transcript locations, the transcriptome release,
the genome with correct chromosome lengths, etc. It allows for automatic
and correct summarization of transcript-level quantifications to the gene-level
via <code>summarizeToGene</code> without the need to manually build
a <code>tx2gene</code> table.</p>
<p><code>tximeta</code> on the first run will ask where the BiocFileCache for
this package should be kept, either using a default location or a temporary
directory. At any point, the user can specify a location using
<code><a href="getTximetaBFC.html">setTximetaBFC</a></code> and this choice will be saved for future sessions.
Multiple users can point to the same BiocFileCache, such that
transcript databases (TxDb or EnsDb) associated with certain Salmon indices
and <code>linkedTxomes</code> can be accessed by different users without additional
effort or time spent downloading and building the relevant TxDb / EnsDb.
Note that, if the TxDb or EnsDb is present in AnnotationHub, <code>tximeta</code> will
use this object instead of downloading and building a TxDb/EnsDb from GTF
(to disable this set useHub=FALSE).</p>
<p>In order to allow that multiple users can read and write to the
same location, one should set the BiocFileCache directory to
have group write permissions (g+w).</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># point to a Salmon quantification file:</span></span></span>
<span class="r-in"><span><span class="va">dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/salmon_dm"</span>, package<span class="op">=</span><span class="st">"tximportData"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dir</span>, <span class="st">"SRR1197474"</span>, <span class="st">"quant.sf"</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">coldata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">files</span>, names<span class="op">=</span><span class="st">"SRR1197474"</span>, condition<span class="op">=</span><span class="st">"A"</span>, stringsAsFactors<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># normally we would just run the following which would download the appropriate metadata</span></span></span>
<span class="r-in"><span><span class="co"># se &lt;- tximeta(coldata)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># for this example, we instead point to a local path where the GTF can be found</span></span></span>
<span class="r-in"><span><span class="co"># by making a linkedTxome:</span></span></span>
<span class="r-in"><span><span class="va">indexDir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dir</span>, <span class="st">"Dm.BDGP6.22.98_salmon-0.14.1"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fastaFTP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ftp://ftp.ensembl.org/pub/release-98/fasta/drosophila_melanogaster/cdna/Drosophila_melanogaster.BDGP6.22.cdna.all.fa.gz"</span>,</span></span>
<span class="r-in"><span>              <span class="st">"ftp://ftp.ensembl.org/pub/release-98/fasta/drosophila_melanogaster/ncrna/Drosophila_melanogaster.BDGP6.22.ncrna.fa.gz"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gtfPath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">dir</span>, <span class="st">"Drosophila_melanogaster.BDGP6.22.98.gtf.gz"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="linkedTxome.html">makeLinkedTxome</a></span><span class="op">(</span>indexDir<span class="op">=</span><span class="va">indexDir</span>, source<span class="op">=</span><span class="st">"LocalEnsembl"</span>, organism<span class="op">=</span><span class="st">"Drosophila melanogaster"</span>,</span></span>
<span class="r-in"><span>                release<span class="op">=</span><span class="st">"98"</span>, genome<span class="op">=</span><span class="st">"BDGP6.22"</span>, fasta<span class="op">=</span><span class="va">fastaFTP</span>, gtf<span class="op">=</span><span class="va">gtfPath</span>, write<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> linkedTxome is same as already in bfc</span>
<span class="r-in"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu">tximeta</span><span class="op">(</span><span class="va">coldata</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> importing quantifications</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> reading in files with read.delim (install 'readr' package for speed up)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 1 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> found matching linked transcriptome:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ LocalEnsembl - Drosophila melanogaster - release 98 ]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> loading existing TxDb created: 2023-08-26 19:49:47</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> loading existing transcript ranges created: 2023-08-26 19:49:48</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Warning: the annotation is missing some transcripts that were quantified.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 5 out of 33706 txps were missing from GTF/GFF but were in the indexed FASTA.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (This occurs sometimes with Ensembl txps on haplotype chromosomes.)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> In order to build a ranged SummarizedExperiment, these txps were removed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> To keep these txps, and to skip adding ranges, use skipMeta=TRUE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Example missing txps: [FBtr0307759, FBtr0084079, FBtr0084080, ...]</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># to clear the entire linkedTxome table</span></span></span>
<span class="r-in"><span><span class="co"># (don't run unless you want to clear this table!)</span></span></span>
<span class="r-in"><span><span class="co"># bfcloc &lt;- getTximetaBFC()</span></span></span>
<span class="r-in"><span><span class="co"># bfc &lt;- BiocFileCache(bfcloc)</span></span></span>
<span class="r-in"><span><span class="co"># bfcremove(bfc, bfcquery(bfc, "linkedTxomeTbl")$rid)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://mikelove.github.io" class="external-link">Michael Love</a>, <a href="https://csoneson.github.io/" class="external-link">Charlotte Soneson</a>, <a href="https://www.peterhickey.org/" class="external-link">Peter Hickey</a>, <a href="https://combine-lab.github.io/" class="external-link">Rob Patro</a>, NIH NHGRI, CZI.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

